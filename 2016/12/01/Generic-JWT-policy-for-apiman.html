<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Generic JWT policy for apiman</title>
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="twitter:site" content="@marcsavy" />
    <meta name="twitter:creator" content="@marcsavy" />
    <meta name="twitter:creator:id" content="205774796" />

    <link rel="shortcut icon" href="http://www.rhymewithgravy.com/favicon.ico">

    <link rel="stylesheet" type="text/css" href="//www.rhymewithgravy.com/themes/casper-msavy/assets/css/screen.css?v=1480618634706" />
    <link rel="stylesheet" type="text/css" href="//www.rhymewithgravy.com/themes/casper-msavy/assets/css/atom-one-light.css?v=1480618634706" />
    <link rel="stylesheet" type="text/css" href="//www.rhymewithgravy.com/themes/casper-msavy/assets/css/font-awesome.min.css?v=1480618634706" />
    
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />

    <link rel="canonical" href="http://www.rhymewithgravy.com/2016/12/01/Generic-JWT-policy-for-apiman.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="The Musings of Marc" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Generic JWT policy for apiman" />
    <meta property="og:description" content="I just pushed an initial (very simple) generic JWT authentication plugin policy to master. It should work with any JWT provider! Let me know how it works for you. Build and install To try it out immediately you will need to build it from source. Just check out the apiman/" />
    <meta property="og:url" content="http://www.rhymewithgravy.com/2016/12/01/Generic-JWT-policy-for-apiman.html" />
    <meta property="article:tag" content="apiman" />
    <meta property="article:tag" content=" apiman-gateway" />
    <meta property="article:tag" content=" apiman-custom-policies" />
    <meta property="article:tag" content=" jwt" />
    <meta property="article:tag" content=" security" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Generic JWT policy for apiman" />
    <meta name="twitter:description" content="I just pushed an initial (very simple) generic JWT authentication plugin policy to master. It should work with any JWT provider! Let me know how it works for you. Build and install To try it out immediately you will need to build it from source. Just check out the apiman/" />
    <meta name="twitter:url" content="http://www.rhymewithgravy.com/2016/12/01/Generic-JWT-policy-for-apiman.html" />
    
    <script type="application/ld+json">
null
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="The Musings of Marc" href="http://www.rhymewithgravy.com/rss/" />
</head>
<body class="post-template tag-apiman tag-apiman-gateway tag-apiman-custom-policies tag-jwt tag-security nav-closed">

    

    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-apiman tag-apiman-gateway tag-apiman-custom-policies tag-jwt tag-security">

        <header class="post-header">
            <h1 class="post-title">Generic JWT policy for apiman</h1>
            <section class="post-meta">
                <span><time class="post-date" datetime="2016-12-01">01 December 2016</time>  on <a href="http://www.rhymewithgravy.com/tag/apiman/">apiman</a>, <a href="http://www.rhymewithgravy.com/tag/apiman-gateway/"> apiman-gateway</a>, <a href="http://www.rhymewithgravy.com/tag/apiman-custom-policies/"> apiman-custom-policies</a>, <a href="http://www.rhymewithgravy.com/tag/jwt/"> jwt</a>, <a href="http://www.rhymewithgravy.com/tag/security/"> security</a></span>
                <span class="author-bar-top">
                    <ul>
                        <a rel="me" href="mailto:marc@rhymewithgravy.com" title="Email Marc">
                            <i class="fa fa-user" aria-hidden="true"></i>
                            <span class="label">Marc Savy</span>
                        </a>
                        <li>
                            <a rel="me" href="https://www.twitter.com/marcsavy" title="Marc's Twitter account">
                                <i class="fa fa-twitter-square" aria-hidden="true"></i>
                                <span class="label">@marcsavy</span>
                            </a>
                        </li>
                        <li>
                            <a rel="me" href="https://uk.linkedin.com/in/marcsavy" title="Marc's LinkedIn account">
                                <i class="fa fa-linkedin-square" aria-hidden="true"></i>
                                <span class="label">marcsavy</span>
                            </a>
                        </li>
                        <li>
                            <a rel="me" href="https://www.github.com/msavy" title="Marc's GitHub account">
                                <i class="fa fa-github-square" aria-hidden="true"></i>
                                <span class="label">msavy</span>
                            </a>
                        </li>
                    </ul>
                </span>
            </section>
        </header>

        <section class="post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>I just pushed an initial (very simple) generic JWT authentication plugin policy to master. It should work with any JWT provider! Let me know how it works for you.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build_and_install">Build and install</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To try it out immediately you will need to build it from source. Just check out the <a href="https://github.com/apiman/apiman-plugins">apiman/apiman-plugins</a> repo and execute:</p>
</div>
<div class="paragraph">
<p><code>mvn clean install</code></p>
</div>
<div class="paragraph">
<p>The plugin coordinates will be:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">G</dt>
<dd>
<p>io.apiman.plugins</p>
</dd>
<dt class="hdlist1">A</dt>
<dd>
<p>apiman-plugins-jwt-policy</p>
</dd>
<dt class="hdlist1">V</dt>
<dd>
<p>1.2.9-SNAPSHOT</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>It isn&#8217;t yet as feature-rich as the <a href="http://www.apiman.io/blog/gateway/security/oauth2/keycloak/authentication/authorization/1.2.x/2016/01/22/keycloak-oauth2-redux.html">Keycloak plugin</a>, but you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Require JWT.</p>
</li>
<li>
<p>Require claims (e.g. sub = foo).</p>
</li>
<li>
<p>Require transport security (TLS, SSL).</p>
</li>
<li>
<p>Require JWT be cryptographically signed (aka. JWS).</p>
</li>
<li>
<p>Validate JWT against a provided public key.</p>
</li>
<li>
<p>Remove auth tokens (prevent them reaching the backend).</p>
</li>
<li>
<p>Set maximum clock skew.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I&#8217;ll expand on this in the near future to add some commonly-used features from the Keycloak plugin:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extraction of roles for authorization</p>
</li>
<li>
<p><s>Forward token fields as headers (e.g. X-Sub = sub)</s> âœ“</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_use_it">How to use it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the <code>Authorization</code> header as <code>Authorization: Bearer &lt;B64 encoded token&gt;</code></p>
</li>
<li>
<p>Set the <code>access_token</code> query parameter as <code>example.com?access_token=&lt;B64 encoded token&gt;</code></p>
</li>
</ul>
</div>
</div>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="http://www.rhymewithgravy.com/author/msavy/" style="background-image: url(https://avatars.githubusercontent.com/u/423513?v&#x3D;3)"><span class="hidden">Marc Savy's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="http://www.rhymewithgravy.com/author/msavy/">Marc Savy</a></h4>

                    <p>Core developer on the @apiman API Management project</p>
                <div class="author-meta">
                    
                    <span class="author-link icon-link"><a href="http://www.rhymewithgravy.com">http://www.rhymewithgravy.com</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Generic%20JWT%20policy%20for%20apiman&amp;url=http://www.rhymewithgravy.com/2016/12/01/Generic-JWT-policy-for-apiman.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.rhymewithgravy.com/2016/12/01/Generic-JWT-policy-for-apiman.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://www.rhymewithgravy.com/2016/12/01/Generic-JWT-policy-for-apiman.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


        <section class="post-comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          var disqus_shortname = 'rhymewithgravy'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>


    </article>

</main>

<aside class="read-next">
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="http://www.rhymewithgravy.com">The Musings of Marc</a> &copy; 2016</section>
            <section class="poweredby">Proudly published with <a href="http://hubpress.io">HubPress</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>

    <script type="text/javascript" src="//www.rhymewithgravy.com/themes/casper-msavy/assets/js/jquery.fitvids.js?v=1480618634706"></script>
    <script type="text/javascript" src="//www.rhymewithgravy.com/themes/casper-msavy/assets/js/index.js?v=1480618634706"></script>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-82902494-1', 'auto');
    ga('send', 'pageview');

    </script>
</body>
</html>
